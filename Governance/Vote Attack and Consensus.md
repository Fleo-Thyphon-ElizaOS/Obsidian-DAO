**Blockchain Voting and Vote Buying**

Blockchains appear to be the perfect technology for online voting. They can act as "bulletin boards," global ledgers that have been hypothetical (but never truly realized) over decades of research into electronic voting. Even better, blockchains enable smart contracts, which can autonomously conduct on-chain elections and eliminate electoral authorities.

Unfortunately, smart contracts are not just good for organizing elections. They are also good for _buying_ votes.

In this blog post, we explain how and why. As an example, we will present a simple, fully implemented vote-buying attack against the popular on-chain system CarbonVote. We will also discuss how trusted hardware allows for even more powerful vote-buying techniques that seem unsolvable even with cutting-edge cryptographic voting protocols.

Finally, we introduce a new form of attack called _Dark DAO_, not to be confused with the ["Dark DAO"](https://medium.com/@oaeee/the-rise-of-the-dark-dao-72b21a2212e3) in the same way that DAOs should not be confused with [The DAO](http://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/). A Dark DAO is a decentralized cartel that buys on-chain votes in an opaque manner ("in the dark"). We present a concrete realization based on Intel SGX.

In such an attack, potentially no one, not even the creator of the DAO, can determine the number of DAO participants, the total amount of money pledged to the attack, or the precise logic of the attack: for example, the Dark DAO might attack a currency like Tezos, secretly collecting coins until it reaches a hidden threshold, then telling its members to short-sell the currency. A Dark DAO also has the unique ability to impose _information asymmetry_ by sending, for instance, short deniable notifications: cartel members might verify the short signal but could themselves generate seemingly authentic false signals to send to outsiders.

The existence of vote-buying minimizing trust and Dark DAO primitives implies that users of all on-chain votes are vulnerable to manipulation and control by plutocrats and coercive forces. This directly implies that all on-chain voting schemes where users can generate their own keys outside of a trusted environment intrinsically degrade into plutocracy, a paradigm [considered widely inferior to democratic models](https://en.wikipedia.org/wiki/Plutocracy) that such protocols attempt to bring on-chain.

**All of our schemes and attacks operate independently of identity controls**, allowing users' actions to be freely bought and sold. This means that schemes relying on user-generated keys linked to users' identities, such as uPort or Circles, are also intrinsically and fundamentally vulnerable to arbitrary manipulation by plutocrats. Our schemes can also be reused to profitably attack proof-of-stake or proof-of-work blockchains, posing serious security problems for all blockchains.

## **Voting on the Blockchain Today**

Blockchain voting systems abound today. There is [Votem](https://votem.com/), an end-to-end verifiable voting system that allows voting using mobile devices and leverages blockchain as a place to securely publish and tally election results. Remix, the popular smart contract IDE, offers an election administration smart contract as a training example. Even more examples can be found [here (1)](https://cointelegraph.com/news/eip-999-why-a-vote-to-release-parity-locked-funds-evoked-so-much-controversy), [here (2)](https://futurism.com/the-dao-heist-undone-97-of-eth-holders-vote-for-the-hard-fork/), and [here (3)](https://ethereumworldnews.com/eos-voting-abp/).

On-chain voting systems face many challenges, including privacy, latency, and scalability. None of these are unique to voting, and all will eventually be surmountable. Vote buying is another story.

In political systems, vote buying is a pervasive and corrosive form of electoral fraud, with a [long history](https://en.wikipedia.org/wiki/Electoral_fraud#Vote_buying) of undermining electoral integrity around the world. Sometimes the price of a vote is a [glass of beer](https://www.washingtonpost.com/politics/decision2012/selling-votes-is-common-type-of-election-fraud/2012/10/01/f8f5045a-071d-11e2-81ba-ffe35a7b6542_story.html). Fortunately, as researchers have [observed](https://polsci.umass.edu/file/904/download?token=wqyQOKoP), normal market mechanisms generally collapse in vote-buying systems for three reasons. First, vote buying is a crime in most cases. In the United States, it is punishable under [federal law](https://www.law.cornell.edu/uscode/text/18/597). Second, where secret ballots are used, compliance is difficult to enforce. A voter can simply drink your beer and vote in secret as they please. Third, even if a voter sells their vote, there is no guarantee that the other party will pay.

No such obstacles exist in blockchain systems. Vote-buying markets can be managed efficiently and effectively using the same powerful tool for administering elections: smart contracts. Pseudonymity and jurisdictional complications provide, as always, some cover against prosecution.

In general, electronic voting systems are in some respects harder to protect against fraud than in-person voting and have been the [subject of general and academic interest](https://en.wikipedia.org/wiki/End-to-end_auditable_voting_systems) for many years. One of the fundamental building blocks was [introduced very early by David Chaum](https://www.freehaven.net/anonbib/cache/chaum-mix.pdf), providing anonymous mix networks for messages that could be sent anonymously by participants with inclusion receipts. Such verifiable end-to-end voting systems, where users can verify that their votes are correctly counted without sacrificing privacy, are not just the domain of theorists and have [actually been used for binding elections](https://www.usenix.org/legacy/event/sec10/tech/full_papers/Carback.pdf).

[Subsequent work by Benaloh and Tuinstra](https://dl.acm.org/citation.cfm?id=195407) has challenged electronic voting schemes, noting that they offer voters a "receipt" that provides cryptographic proof of how a given vote was cast. This would allow for extremely effective vote buying and coercion, clearly undesirable properties. The authors defined a new property, _receipt-freedom_, to describe voting schemes where no cryptographic proof is possible. [Further work by Juels, Catalano, and Jakobsson](https://eprint.iacr.org/2002/165.pdf) modeled even more powerful coercive adversaries, showing that even systems without receipts were insufficient to prevent coercion and vote buying. This work defined a new security definition for voting schemes called "resistance to coercion," providing a protocol in which no malicious party could successfully coerce a user in a way likely to alter election outcomes.

In their work, Juels et al. note that "the security of our construction then relies on the generation of key pairs… by a trusted third party, or alternatively, on an interactive key generation protocol that is computationally secure such as [24] between players." Such "trusted key generation," "trusted third party," or "trusted setup" assumptions are standard in the academic literature on coercion-resistant voting schemes. Unfortunately, these requirements do not translate into the permissionless [model](https://eurocrypt.iacr.org/2017/slides/A04-analysis-of-the-blockchain.pdf), in which nodes can enter and leave at any time without knowing each other a priori. This means (somewhat) intrinsically that users generate their own keys in all these deployed systems and cannot leverage trusted multiparty key generation or any centralized key service arbiter.

The blockchain space today, with predictable outcomes, continues its tradition of ignoring decades of studies and instead opts for implementing the most naive possible form of voting: directly counting weighted votes in coins stored in plain text on-chain. Unfortunately, it is unclear that anything better than such a plutocracy is achievable on-chain. We show that the permissionless model is fundamentally hostile to voting. Despite any attempts at mitigation based on identity or second layer solutions, **all permissionless voting systems** (or systems allowing users to generate their own keys in an untrusted environment) are vulnerable to the same style of vote buying and coercive attacks. Many vote-buying attacks can also be used for coercion, forcibly chaining users to particular voting choices.

![Man in a suit pushing a dollar bill into the voter's pocket.](file:////Users/sebaastiencailhol/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image001.jpg)

_That's a nice on-chain vote you have there..._

It is worth noting that the severity of corruption attacks in such protocols has been [partially explored by Vitalik Buterin](https://vitalik.ca/general/2018/03/28/plutocracy.html), although concrete mechanisms have not been provided. We describe here frictionless mechanisms for voting, identity buying, coercion, and high-level coordination and discuss the implications of these particular mechanisms.

## **Flavors of Attack**

Consider a very simple voting system: holders of a token get one vote per token they hold and can change their votes continuously until a certain number of closing blocks. We will use this simple "EZVote" scheme to create an intuition for how our attacks can function in any on-chain voting mechanism.

There are several possible increasing types of attacks against such a scheme.

### Simple Smart Contracts

The simplest low-coordination attack against on-chain voting systems involves buying smart contracts. Such smart contracts would simply pay users for a provable vote for an option

 (or to participate in the vote, or to abstain from voting if the vote is not anonymous). In EZVote, the smart contract could be a simple contract that holds your ERC20 until the end date, votes yes, and returns it to you; all guarantees of the contract could be enforced by the underlying blockchain.

Such a scheme has advantages in that it only requires the trust assumptions already inherent in the underlying system, but it also has substantial disadvantages. On the one hand, it is probably possible to publicly state how many votes are purchased after the elections end, as this is necessary to manage the flow of payments in today’s smart contract systems. Additionally, the nature of bribery on the platform exposes it to [censorship](https://www.ethnews.com/arbitration-forum-orders-more-eos-accounts-frozen-but-apparent-hoax-muddies-waters) by stakeholders interested in preserving the health of the platform/system.

Depending on the nature of the voting system and the underlying protocol, there may be workarounds for these disadvantages. Voters could, for example, provide a ring signature proving to a vote buyer that they are on a list of voters who are voting yes in exchange for payments. We leave the implementation details and the generalizability of these schemes open.

In general, any private smart contract mechanism can also be used for private vote buying, thereby resolving the public nature of an attack based on smart contracts; cryptographically, an equivalent would be the vote buyer and seller generating together a secret key for fund storage via MPC, signing two transactions: a yes vote and a transaction that releases funds to the vote seller after the interval ends. The vote seller would move funds to this key only after having possessed the transaction guaranteeing a refund and payment.

This would resemble previous work on [distributed certificate generation](https://arxiv.org/pdf/1706.03370.pdf), adding a security analysis to ensure fairness. A naive implementation of such a system would hinder users' ability to use the funds for other purposes during the vote (such actions are possible but require cooperation on the part of the vote buyer; alternatively, a trusted/linked third-party fiduciary could be used).

### Buying Trusted Hardware

An even more concerning vote-buying attack scheme involves the use of trusted hardware, such as [Intel SGX](https://en.wikipedia.org/wiki/Software_Guard_Extensions). Such hardware has a key feature called [remote attestation](https://en.wikipedia.org/wiki/Trusted_Computing#Remote_attestation). Essentially, if Alice and Bob communicate over the Internet, the trusted computing performed by SGX allows Alice to prove to Bob that she is executing a certain piece of code.

Trusted hardware is generally viewed as a means to prove that you are executing code that will not be malicious: for example, it is used in [DRM](http://www.trulyprotect.com/docs/PII.pdf) to prove that a user will not copy files that are only granted to them temporarily, such as movies. Instead, we will use trusted hardware to _chain_ cryptocurrency users, paying or forcing them to use cryptocurrency wallets based on trusted hardware that **provenly restrict their allowed behavior space** (for example, forcing them not to vote a certain way during an election) or **allowing the vote buyer to use reduced but limited access to a user's key** (for example, a vote buyer can force a user to sign "I vote A," but cannot steal or spend a user's money).

The simplest way to deploy such technology for vote buying is to simply allow users to prove that they are using the vote buyer's malicious wallet code in exchange for payment, secured on both sides by remote attestation technology.

In our "EZVote" example, a user would simply use a cryptocurrency wallet loaded on Intel's SGX, running the vote buyer's program. SGX would guarantee to the user that the wallet could never steal the user's money (unless Intel were colluding with the vote buyer). The user can use the wallet in the same way they can with a normal Ethereum wallet, including withdrawing their money (although in this case, they would not get paid). The user manages their own wallet and does not need to trust a third party for the control or security of their funds. The user may not need to trust Intel or the trusted hardware provider for the security of their funds, as they can create their own wallet!

When a predefined trigger condition occurs, such a SGX program would automatically vote on EZVote as the vote buyer's command and send a receipt to the vote buyers. The vote buyer would be managed by a SGX enclave that would keep a total of all users claiming to have voted yes, along with a list of their addresses. Given trust in SGX, the vote buyer does not need to see the complete list of member users or know the total amount promised. At the end of the vote, the vote buyer's enclave would pay all users who had not moved their funds or changed their vote. This would be accomplished by the enclave periodically publishing a Merkle root summarizing the users to be paid on-chain, providing proof to each user that they will eventually be paid. Users can claim payment after a certain period by providing proof of inclusion in the published Merkle history.

### Hidden Trust Hardware Cartels (Dark DAO)

An even more concerning attack occurs when trusted hardware is combined with the idea of a [DAO](https://en.wikipedia.org/wiki/Decentralized_autonomous_organization), giving rise to a trustless organization focused on manipulating cryptocurrency votes.

![Presentation of a simple Dark DAO architecture based on SGX](file:////Users/sebaastiencailhol/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image002.png)

_An example of a basic Dark DAO._

The figure above describes a possible architecture. Vote buyers would support the DAO by executing a network of SGX enclaves that themselves run a consensus protocol (represented here as a dark cloud to indicate its invisibility from the outside). Users would communicate with this enclosed network and provide proof that they are running an "vote-buying" Ethereum wallet (for example) with a current balance of X coins. This "malicious wallet" attests to the execution of the attack code for which a vote buyer pays, and the vote buyer attests that they execute guaranteed code to pay the user at the end of the attack (likely in combination with a smart contract-based protocol that cryptoeconomically reinforces liveliness and honesty).

Vote buyers can track the total amount of funds pledged to vote via the system, hiding this fact from the outside world using privacy features built into SGX. Users can receive provable payments for their participation in such a system, obtaining a property similar to all-or-nothing settlement in [SGX-based decentralized exchanges](https://eprint.iacr.org/2017/1153.pdf). Vote buyers can obtain provable assurance that clients will never cast votes that contradict the desired voting policy.

What makes such an organization _dark_ is that vote buyers do not need to reveal to _anyone_ (potentially even to themselves) how many users participate in the system. The system could simply accumulate users, paying users to run the attacker’s custom wallet software until a certain threshold (e.g., coins held by such software) is reached that activates an attack; in this way, failed attempts do not need to be detectable. More damaging, the individual incentives of any small user clearly point toward compliance with the system. If small users think their vote does not matter, they are likely to profit from it with no perceived marginal downside. This is especially the case in on-chain votes, which empirically [exhibit extremely low participation rates](https://www.reddit.com/r/eos/comments/8r3xen/eos_mainnet_is_live_169_voter_turnout_congrats/). Non-voting users can be ideal targets for selling their votes.

Dark DAO operators can still obfuscate matters by launching attacks against choices that vote buyers _actually oppose_ as potential false flag operations or smear campaigns; for example, Bob could run a Dark DAO working in favor of Alice to [delegitimize the outcome of an election](https://twitter.com/realdonaldtrump/status/787699930718695425) that Bob thinks he is likely to lose. The activation threshold, payment timeline, overall attack strategy, number of users in the system, total amount of money pledged to the system, etc., can be kept private or selectively or globally disclosed, making these DAOs ultimately adjustable for structured incentive changes.

Since the organization exists off-chain, no [block producer cartel](https://www.ethnews.com/arbitration-forum-orders-more-eos-accounts-frozen-but-apparent-hoax-muddies-waters) or other system participants can detect, censor, or stop the attack.

Such an obscure organization presents several immediate practical disadvantages. The main one is that for use on Intel SGX, a license would need to be granted by Intel, an unlikely event for malware. Additionally, side-channel attacks, hidden software backdoors, or platform attacks in Intel's SGX or the Dark DAO wallet audit could weaken the scheme, although as trusted hardware continues to advance and develop, it is highly likely that the cost of such attacks will increase significantly. Ultimately, we expect other trusted hardware to provide Intel SGX's remote attestation capabilities, meaning SGX will not be necessary for such an attack; this is why we interchangeably use "SGX" with "trusted hardware." For instance, remote attestation is achievable [on certain secure Android processors](http://profsandhu.com/zhang/pub/trust10-android.pdf). Our schemes work on any hardware device that allows for confidential data and remote attestation.

## **Attacks on Classic Schemes: CarbonVote and EIP999**

To demonstrate the effectiveness of these vote-buying strategies, we first examine critical co-votes for governance carried out in existing cryptocurrency systems.

 The most significant of this type of vote may have been the [CarbonVote DAO](http://v1.CarbonVote.com/). The operation of this vote was simple: accounts sent money to one address to vote yes, and to another to vote no. Each address was a contract that recorded the vote of a given address. The CarbonVote interface then tallied the votes and displayed the net balances of all accounts that had voted yes and/or no. Subsequent votes replaced previous ones, allowing users to change their minds. At the end of the voting, a snapshot of support was taken and used to gauge community sentiment. This style of voting is reused for other controversial ecosystem issues, including [EIP-186](http://CarbonVote.com/).

A potential trust-minimized vote-buying smart contract in this framework involves the use of an escrow; users send Ether to an ERC20 token contract that holds the Ether until the end of the vote. For each Ether they deposit, users receive 1 VOTECOIN.

The contract is preprogrammed to vote yes at the end of the vote with 100% of the user-held Ether. Once the vote is finished, each VOTECOIN token becomes fully redeemable for the original Ether that created it. Users recover their original Ether, along with any bribes the vote buyers wish to pay them for this service.

We have set up [a complete open-source proof of concept](https://gitlab.com/relyt29/votebuying-CarbonVote) of such a contract, allowing any vote buyer to contribute funds to the contract's BRIBEPOOL. Users can be paid by BRIBEPOOL by temporarily locking their Ether in the contract and can recover 100% of their Ether at the end of the target vote. An attack may pay vote sellers from BRIBEPOOL in advance (once they lock the coins, votes are guaranteed), either as dividends over time or both.

![Vote buying smart contract code for the CarbonVote DAO](file:////Users/sebaastiencailhol/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image003.png)

_Vote buying smart contract code for the CarbonVote DAO_

Users can also sell their VOTECOIN after locking their Ether, effectively making VOTECOIN a symbolized vote-buying derivative. Vote sellers can then instantly unload their exposure to all risks introduced by locking funds to parties indifferent to the vote outcome: because each ERC20 is guaranteed by design to ultimately receive all the original ETH, it essentially creates a one-way funnel from the base asset to a dedicated derivative asset for voting in a predefined manner. Buyers uninterested in the vote outcome must still lock their ETH if they are assured a non-negative gain, and essentially have the option to offload later onto other indifferent buyers as well. If BRIBEPOOL dividends are paid over time to VOTECOIN in addition to the upfront payment,

This smart contract can be simplified with the use of oracles such as [Town Crier](http://www.town-crier.org/) (multiple oracles, prediction markets, etc., can also be combined). Given that the CarbonVote system publishes results, including full voter logs [on Etherscan](https://etherscan.io/address/0x71caff5fd6facbaf1863426ac05b3703636a9bb9#events), it is relatively straightforward to verify how someone voted using external web scraping oracles, paying them if their vote included in the final snapshot matched the buyers' preference.

A Dark DAO-type model could also trivially be employed. Each user simply runs a wallet that, sometime after each transfer transaction, also votes the desired way on CarbonVote (in fact, this can become standard behavior for many wallets). The user is paid only if such votes are recorded, so they are incentivized to ensure that this voting transaction is included on-chain. There is no way for the network to tell how many votes in a given CarbonVote are generated by such a vote-buying cartel, and how many are legitimate.

The ability to minimize trust when pooling assets among multiple vote buyers is inherent in each of these systems; corrupt smart contracts could simply allow anyone to pay into the BRIBEPOOL, and SGX networks can be architected in the same way for open participation.

Certain regimes, such as the [EIP999 vote](https://www.etherchain.org/coinvote/poll/35/), have even more severe problems. In these schemes, if a user votes twice, the last of these votes is chosen. A simple and severe attack then consists of simply collecting signatures on the user's "yes" and "no" votes, spamming the chosen signature toward the end of the voting period, and relying on a capacity to overwhelm the blockchain to ensure that most of these votes persist. Alternatively, as contract deployers can vote for all funds of a given contract, another attack consists of simply forcing a user to use a wallet based on a contract during the duration of the vote deployed by the vote buyer, who can then arbitrarily control the votes of all funds locked in contracts without custody of those funds.

Bitcoin is not immune to this problem either. [The Bitcoin community often relies](https://news.ycombinator.com/item?id=11228875) on coins, and similar vote-buying schemes can be applied (like Ethereum smart contracts as in [this work](https://fc18.ifca.ai/bitcoin/papers/bitcoin18-final14.pdf), or in the Dark DAO style; Bitcoin itself does not provide native support for contracts rich enough to buy votes).

## **Beyond Voting - Attacking Consensus**

Astute readers may point out that all permissionless blockchains intrinsically rely on some form of permissionless voting, namely the consensus algorithm itself. Whenever a blockchain reaches [global consensus on certain attributes of state](https://medium.com/@chrshmmmr/consensus-in-blockchain-systems-in-short-691fc7d1fefe), what happens is essentially a permissionless vote (often weighted in coins or PoW) in a permissionless framework.

It may not be surprising that "vote buying" has been explored in these contexts. For example, smart contracts on Ethereum [can be used](https://fc18.ifca.ai/bitcoin/papers/bitcoin18-final14.pdf) to attack Ethereum and other blockchains through censorship, revising history, or incentivizing empty blocks. Such attacks act directly on the proof-of-work voting itself, bribing miners based on their weighted work. There is little reason to believe that proof-of-stake systems would be immune to similar attacks, especially in the presence of complex [delegated voting structures](http://docs.bitshares.org/bitshares/dpos.html) whose incentives may not be clear and whose formal analysis may be incomplete or nonexistent.

A troubling concept related to our exploration of Dark DAOs for vote buying is what we call the "Fishy DAO," named after the [classic flash game](http://fishy-flash-game.com/) in which you start as a small fish. The rules are simple; you can eat competing smaller fish, but not fish of the same size or larger than you. You grow a little after each meal until you (if you're lucky) end up dominating the ocean. A modern equivalent that doesn't require Flash and adds networking is [agar.io](http://agar.io/#ffa).

![Image from the Flash game "Fishy"](file:////Users/sebaastiencailhol/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image004.jpg)

_It's like Fishy, but the little fish can also gang up against the bigger ones!_

A Fishy DAO would use Dark DAO-like technology as described above to do the same for blockchains. Using SGX, Fishy DAO members can receive non-transferable notifications (DAO members can verify the authenticity of the message, but non-members cannot tell if a message is faked) when an attack threshold is reached, allowing them to short-circuit currency markets shortly before such an attack. Each blockchain Fishy DAO attack brings some profit to Fishy DAO, and the subsequent publicity even from failed attacks gives Fishy DAO notoriety with profit-seeking but perhaps unethical research (in some frameworks). If Fishy DAO fails to meet the required thresholds, Fishy DAO simply disappears and refunds its participants, potentially burning but not necessarily some of their money to incentivize recruitment.

Fishy DAO requires Dark DAO technology, as if it were run in the open with a smart contract, observable participation rates would provide market signals for the price of the underlying blockchain, making the attack unprofitable by allowing risk accounting. It is the cryptographically enforceable information asymmetry between DAO members and the broader ecosystem participants that makes such an attack possible.

## **Other Applications**

Note that Dark DAOs have implications _well_ beyond the above. For example, consider a Dark DAO aimed at profitably buying users' basic income identities, paying up front for a small amount to receive the regular payments of an individual's basic income. Or a Dark DAO for securely performing credit checks on identity based on keys by renting (with minimized trust limitations) those keys to users with good credit. Or a Dark DAO managing a diabolical mining pool, proving an attack on an ASIC-based proof-of-work cryptocurrency with an unstoppable pool of potentially undetectable attacks.

One can also imagine that with identity, there may be social safeguards against buying behavior in the identity system itself. For example, some identity systems may allow a user to appear in person to revoke or manage identities, which could socially circumvent automated technical protections against identity theft. There are still ways around this: the classic lending solution is collateral. Potentially, a "guarantor" like a company could also provide social guarantees of repayment through physical/legal intimidation and contracts for users who cannot afford collateral. Payday lenders and bail bond companies would be perfectly suited to such a type of business

 if such a permissionless basic income system were ever deployed alongside existing market systems.

The coordination space for mechanisms in blockchains is vast and the environment hostile. All identity-based, vote-based, or financially incentivized schemes must be highly attentive to the implications of the underlying permissionless model on long-term viability, scalability, and security.

## **Key Takeaways**

Perhaps you are an academic skimming through this article, or perhaps an interested user wondering exactly what all this means. There are a few interesting and surprising ideas (in the research literature) to draw from our thought experiments above:

1. **Permissionless electronic voting *requires* trusted hardware.** The most surprising outcome may be this one. In any model where users can generate their own keys (required for the "permissionless" model), low-coordination corruption attacks are intrinsically possible using trusted hardware as described above. The only defense against this is more reliable hardware: to know that a user has access to their own key hardware (and therefore cannot be coerced or bribed), some assurance is required that the user has seen their key. Trusted hardware can do this via a trusted hardware token setup channel (similar to governments using electronic voting for democracy), or via an SGX-based system that ensures that all voters have seen their key hardware revealed to any operating system they run. This intrinsically implements the kind of "trusted setup/key generation" assumptions that [university electronic voting systems have been using for years](https://www.cs.cornell.edu/~clarkson/papers/clarkson_duvote.pdf). Clearly, in the presence of trusted hardware, such assumptions are _necessary_ for any voting, and votes can be bought/sold/corrupted/coerced with low friction in the absence of this assumption, a surprising outcome with serious implications in on-chain voting.

2. **The space of voting and coordination mechanisms is vast and extremely poorly understood.** As explored through concrete examples of how to manage, for example, smart contract voting and voting changes on Ethereum, it is clear that a wide range of design decisions fundamentally alters the incentive structures of voting mechanisms (we explore them in Appendix A below). These mechanisms are extremely complex, and their incentive structures can be altered by other coordination mechanisms such as smart contracts and trusted hardware-based DAOs. The properties of these mechanisms, especially when multiple of these mechanisms interact or are actively attacked by resource-endowed actors, are extremely poorly understood. No mechanism of this type should be used anytime soon for direct on-chain decision-making.

3. **The same class of vote-buying attacks works for any identity system.** These attacks target not just votes. Imagine an identity system that gives users the right to a basic income, paid out weekly. I can simply pay you cash in advance to buy your identity and thus a share of income for the next year, and I should indeed do so if my time value of money is less than yours (as wealth asymmetries often imply). This applies to any system involving identity: with relatively low trust, the behavior of users' identities can be coerced, and these constraints can be bought and sold on the free market. This has a serious and fundamental impact on the robustness of any on-chain economic mechanism with an identity component.

4. **On-chain voting fundamentally degrades into plutocracy.** Voting and democracy fundamentally rest on assumptions of secret ballots and identity infrastructure that only exist in the meatspace. These assumptions do not apply to blockchains, rendering the same techniques fundamentally broken in a permissionless model. External identity systems, even trusted ones, do not solve the problem as long as users can generate their own keys (see above).

5. **Hard fork-based governance offers users the only way out of such a plutocracy.** A natural question to ask given the above is whether we have already arrived at plutocracy. The answer is probably "no." There is evidence that the [ad hoc, informal governance models based on forks that govern blockchains like Bitcoin and Ethereum actually provide robust protection of user rights](https://pdaian.com/blog/stop-worrying-love-etc/). In this model, any upgrade must offer users an active choice, and groups of users can choose to withdraw if they disagree with rule changes. On-chain voting, on the other hand, creates a natural default that, especially when combined with inattentive or indifferent users, can create strong anti-fork inertia around maintaining coinvote.

6. **The interaction of multiple blockchains can break the incentive compatibility of all chains.** Importantly and critically, the Fishy DAO-style attack we explored shows that multiple competing blockchains have the capacity to fundamentally affect the internal balance of all these chains. For example, in a world with a single smart contract system, Ethereum, internal incentives can lead to stable equilibria. With two players and the outsider incentivized to launch a corruption attack to destroy their competitors, such equilibria can be disrupted, altered, and destroyed. An open and surprisingly underexplored area of critical research is the modeling of the macroeconomics of competition between blockchains, allowing a better understanding of how exactly these internal equilibria can fail. We find it intuitively ~ certain that critical black swan events are currently lurking in the complexities of blockchain governance and interoperability.

Clearly, all this requires further exploration, adjustment, and evidence. But I believe we have at least given a sense of why we think the above holds in a principled analytical framework.

## **Conclusion**

The trend of on-chain voting in blockchain draws from the long human tradition of voting and democracy. Unfortunately, the guarantees we have in the real world, such as secret voting/forced denial, approximate identity controls, and accountability for widespread fraud, simply are not available in the permissionless model. When user-generated public keys are used, on-chain voting is unable to guarantee that these users have anti-coercion safeguards. Elaborate voting schemes do little to alleviate (and in many cases actually exacerbate) the problem. On-chain voting systems further complicate incentives, creating an unstable and tangled mess of incentives that can at any time be altered by trustless smart contracts or vote-buying, corruption, and Dark DAO-style griefing.

We encourage the community to be very skeptical of the outcome of any on-chain vote, especially as on-chain voting becomes an increasingly fundamental part of decision-making in blockchain systems. The space to design mechanisms that allow for new forms of abuse with lower coordination costs than ever supports the position that votes should be used for signals rather than decisions, and that a wide variety of voting mechanisms should fill these roles. Without such guarantees, it remains possible that all on-chain voting systems degrade into plutocracy through direct voting and vote buying, and even the tokenization of votes.

Such attacks have substantial implications for the future security of all blockchain-based voting systems.

## **Acknowledgments**

We would like to thank [Patrick McCorry](https://twitter.com/paddyucl) for his helpful and insightful comments throughout the lifecycle of this post and his pioneering work on vote buying and on-chain voting systems.

We also thank [Omer Shlomovits](https://twitter.com/OmerShlomovits) and [István András Seres](https://twitter.com/istvan_a_seres) for their helpful feedback on [early access versions](http://eepurl.com/dyf3WD) of this article.

## **Appendix A - Distinguishers of On-Chain Voting**

We note several distinguishing factors in on-chain voting systems:

1. **Vote-changing capability:** if users cannot change their vote, trivial vote buying is possible with any method providing a verifiable receipt. A smart contract can simply bribe users in advance for their vote, which can no longer be changed. However, most schemes allow users to change or withdraw their votes, meaning corruption requires an element of continuous time (or to be executed after taking a snapshot of the vote). The exponential increase in payments over time offers an interesting solution that discourages coin movement and encourages long-term signaling, and end-of-vote payment bonuses are tools that potential vote buyers can use to create viable vote-buying systems when users _are_ allowed to change votes.

2. **Smart contract/delegated vote:** who can vote for funds stored by smart contracts? This is an open question that poisons existing designs; the original CarbonVote allows any contract that can call a function to vote and change its mind later. The EIP999 vote [allows deployers](https://twitter.com/edmundedgar/status/987300021845442560) of contracts to vote on behalf of contracts, a decision widely criticized as intended to influence vote outcomes. However, neither of these designs appears ideal. Indeed, it seems intuitively difficult for a single design to fairly capture all the nuances of custody in smart contracts: smart contracts holding funds can range from simple multisig accounts to complex decentralized organizations with their own revenue streams and inter-contract financial relationships. Which of these pieces has the right to vote, and how to fairly allocate those rights remains a wholly unexplored philosophical requirement for building a fair on-chain voting system. Forcing contract authors to provide explicit functionality is likely also insufficient, as the very requirements of that functionality may change in the future without backward compatibility (via on-chain voting or forks).

3. **Denial/provability:** all schemes explored in this article have characteristics that make them particularly conducive to vote buying: they provide the voter with a form of cryptographic proof minimizing trust of their vote, either through a chain log, a web interface, or the state of a smart contract. Such systems are particularly vulnerable to vote buying because they facilitate the validation of votes through smart contract-like logic. Some [traditional electronic voting schemes](https://ieeexplore.ieee.org/abstract/document/4561221/) in the academic literature offer a property known as resistance to coercion. In these schemes, a user [can change their mind after coercion](https://eprint.iacr.org/2002/165.pdf) using the key they use to vote, and votes

 are not attributable to individual users. **In general, privacy issues related to votes associated with any long-standing identity type, especially those holding coins, are serious.** Such concerns would be completely disqualifying for any serious voting system in the real world, and should likely be disqualifying in all thoughtful on-chain voting design criteria. 

[https://hackingdistributed.com/2018/07/02/on-chain-vote-buying/](https://hackingdistributed.com/2018/07/02/on-chain-vote-buying/)

#Governance 